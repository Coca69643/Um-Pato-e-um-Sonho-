/* DUCK DREAM STUDIOS - UPDATE v0.0.1 
   Sistema de Configurações Completo
*/

// 1. GESTÃO DE ESTADO E PERSISTÊNCIA
const DEFAULT_SETTINGS = {
    graficos: { sombras: true, particulas: true, brilho: 100 },
    audio: { master: 0.7, musica: true, sfx: true },
    interface: { escalaHUD: 1, opacidade: 0.8 },
    jogabilidade: { canhoto: false, sensibilidade: 0.5 }
};

let Configs = JSON.parse(localStorage.getItem('duckDreamSettings')) || DEFAULT_SETTINGS;

function salvarConfigs() {
    localStorage.setItem('duckDreamSettings', JSON.stringify(Configs));
    aplicarAlteracoes();
}

// 2. APLICAÇÃO DAS MUDANÇAS NO JOGO
function aplicarAlteracoes() {
    // Interface - Lado do Joystick e Opacidade
    const joystick = document.getElementById('joystick-ui'); // Mude para a ID do seu joystick
    const botoesAcao = document.getElementById('botoes-acao'); // Mude para a ID dos seus botões
    const hud = document.querySelector('.game-hud');

    if (joystick && botoesAcao) {
        joystick.style.left = Configs.jogabilidade.canhoto ? 'auto' : '30px';
        joystick.style.right = Configs.jogabilidade.canhoto ? '30px' : 'auto';
        botoesAcao.style.right = Configs.jogabilidade.canhoto ? 'auto' : '30px';
        botoesAcao.style.left = Configs.jogabilidade.canhoto ? '30px' : 'auto';
    }

    if (hud) {
        hud.style.opacity = Configs.interface.opacidade;
        hud.style.transform = `scale(${Configs.interface.escalaHUD})`;
    }

    // Áudio (Exemplo para controle global)
    if (window.bgMusic) {
        window.bgMusic.volume = Configs.audio.musica ? Configs.audio.master : 0;
    }

    console.log("Update v0.0.1: Configurações Aplicadas!");
}

// 3. INTERFACE DO MENU (HTML/CSS)
function abrirMenuConfig() {
    // Criar Overlay se não existir
    if (document.getElementById('modal-config')) return;

    const overlay = document.createElement('div');
    overlay.id = 'modal-config';
    overlay.style = "position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:10000; display:flex; align-items:center; justify-content:center; font-family:'Courier New', Courier, monospace;";

    overlay.innerHTML = `
        <div style="background:#333; border:4px solid #fff; width:90%; max-width:500px; padding:20px; color:white; position:relative;">
            <h2 style="text-align:center; color:#ffff00; margin-top:0;">CONFIGURAÇÕES</h2>
            
            <div style="display:flex; gap:5px; margin-bottom:15px; flex-wrap:wrap; justify-content:center;">
                <button onclick="renderAba('graficos')">GRÁFICOS</button>
                <button onclick="renderAba('audio')">ÁUDIO</button>
                <button onclick="renderAba('ui')">INTERFACE</button>
                <button onclick="renderAba('jog')">JOGABILIDADE</button>
            </div>

            <div id="container-aba" style="background:#222; padding:15px; border:2px solid #555; min-height:180px;">
                </div>

            <button onclick="fecharMenu()" style="width:100%; padding:10px; margin-top:15px; background:#e74c3c; color:white; font-weight:bold; border:none; cursor:pointer;">FECHAR E SALVAR</button>
        </div>
    `;

    document.body.appendChild(overlay);
    renderAba('graficos'); // Inicia na aba de gráficos
}

function renderAba(nome) {
    const container = document.getElementById('container-aba');
    let html = "";

    switch(nome) {
        case 'graficos':
            html = `
                <label>BRILHO: ${Configs.graficos.brilho}%</label><br>
                <input type="range" min="50" max="150" value="${Configs.graficos.brilho}" oninput="Configs.graficos.brilho = this.value; salvarConfigs()"><br><br>
                <label><input type="checkbox" ${Configs.graficos.sombras ? 'checked' : ''} onchange="Configs.graficos.sombras = this.checked; salvarConfigs()"> ATIVAR SOMBRAS</label>
            `;
            break;
        case 'audio':
            html = `
                <label>VOLUME MASTER: ${Math.round(Configs.audio.master * 100)}%</label><br>
                <input type="range" min="0" max="1" step="0.1" value="${Configs.audio.master}" oninput="Configs.audio.master = this.value; salvarConfigs()"><br><br>
                <label><input type="checkbox" ${Configs.audio.musica ? 'checked' : ''} onchange="Configs.audio.musica = this.checked; salvarConfigs()"> MÚSICA</label><br>
                <label><input type="checkbox" ${Configs.audio.sfx ? 'checked' : ''} onchange="Configs.audio.sfx = this.checked; salvarConfigs()"> EFEITOS (SFX)</label>
            `;
            break;
        case 'ui':
            html = `
                <label>OPACIDADE HUD: ${Math.round(Configs.interface.opacidade * 100)}%</label><br>
                <input type="range" min="0.2" max="1" step="0.1" value="${Configs.interface.opacidade}" oninput="Configs.interface.opacidade = this.value; salvarConfigs()"><br><br>
                <label>TAMANHO DA HUD</label><br>
                <select onchange="Configs.interface.escalaHUD = this.value; salvarConfigs()">
                    <option value="0.8" ${Configs.interface.escalaHUD == 0.8 ? 'selected' : ''}>PEQUENA</option>
                    <option value="1" ${Configs.interface.escalaHUD == 1 ? 'selected' : ''}>NORMAL</option>
                    <option value="1.2" ${Configs.interface.escalaHUD == 1.2 ? 'selected' : ''}>GRANDE</option>
                </select>
            `;
            break;
        case 'jog':
            html = `
                <label><input type="checkbox" ${Configs.jogabilidade.canhoto ? 'checked' : ''} onchange="Configs.jogabilidade.canhoto = this.checked; salvarConfigs()"> MODO CANHOTO</label><br><br>
                <label>SENSIBILIDADE</label><br>
                <input type="range" min="0.1" max="1" step="0.1" value="${Configs.jogabilidade.sensibilidade}" oninput="Configs.jogabilidade.sensibilidade = this.value; salvarConfigs()">
            `;
            break;
    }
    container.innerHTML = html;
}

function fecharMenu() {
    const modal = document.getElementById('modal-config');
    if (modal) modal.remove();
}

// Inicializa o jogo aplicando as configs salvas
document.addEventListener('DOMContentLoaded', aplicarAlteracoes);













